<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Artificial Hydrocarbon Networks in R • ahnr</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Artificial Hydrocarbon Networks in R">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ahnr</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/ahn.html">Artificial Hydrocarbon Networks in R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jroberayalas/ahnr">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><script src="ahn_files/htmlwidgets-0.9/htmlwidgets.js"></script><link href="ahn_files/vis-4.20.1/vis.css" rel="stylesheet">
<script src="ahn_files/vis-4.20.1/vis.min.js"></script><script src="ahn_files/visNetwork-binding-2.0.3/visNetwork.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Artificial Hydrocarbon Networks in R</h1>
                        <h4 class="author">Jose Roberto Ayala Solares</h4>
            
            <h4 class="date">2018-03-31</h4>
      
      <small>Source: <a href="https://github.com/jroberayalas/ahnr/blob/master/vignettes/ahn.Rmd"><code>vignettes/ahn.Rmd</code></a></small>

    </div>

    
    
<p><code>ahnr</code> is a package that implements the artificial hydrocarbon networks developed by <a href="http://www.up.edu.mx/es/investigador/25611/hiram-eredin-ponce-espinosa-dr">Hiram Ponce</a>. Most of the work is based on the book <a href="http://www.springer.com/gb/book/9783319024714">Artificial Organic Networks</a>.</p>
<div id="quick-start" class="section level2">
<h2 class="hasAnchor">
<a href="#quick-start" class="anchor"></a>Quick Start</h2>
<p>Here are some quick examples to get you started.</p>
</div>
<div id="create-a-network-for-a-siso-sytem" class="section level2">
<h2 class="hasAnchor">
<a href="#create-a-network-for-a-siso-sytem" class="anchor"></a>Create a network for a SISO sytem</h2>
<p>The following code let’s you create the data to train an artificial hydrocarbon network.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(ahnr)</code></pre></div>
<pre><code>## 
## Attaching package: 'ahnr'</code></pre>
<pre><code>## The following object is masked from 'package:stats':
## 
##     predict</code></pre>
<pre><code>## The following object is masked from 'package:graphics':
## 
##     plot</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     summary</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create data</span>
<span class="kw">set.seed</span>(<span class="dv">123</span>)
x &lt;-<span class="st"> </span><span class="dv">2</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>;
x &lt;-<span class="st"> </span><span class="kw">sort</span>(x)

y &lt;-<span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.1</span>) <span class="op">*</span><span class="st"> </span>(<span class="fl">0.05</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>) <span class="op">+</span><span class="st"> </span><span class="kw">atan</span>(pi<span class="op">*</span>x)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.1</span> <span class="op">&amp;</span><span class="st"> </span>x <span class="op">&lt;</span><span class="st"> </span><span class="fl">0.6</span>) <span class="op">*</span><span class="st"> </span>(<span class="fl">0.05</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>) <span class="op">+</span><span class="st"> </span><span class="kw">sin</span>(pi<span class="op">*</span>x)) <span class="op">+</span><span class="st"> </span>
<span class="st">    </span>(x <span class="op">&gt;=</span><span class="st"> </span><span class="fl">0.6</span>) <span class="op">*</span><span class="st"> </span>(<span class="fl">0.05</span> <span class="op">*</span><span class="st"> </span><span class="kw">runif</span>(<span class="dv">1000</span>) <span class="op">+</span><span class="st"> </span><span class="kw">cos</span>(pi<span class="op">*</span>x))

<span class="kw"><a href="../reference/plot.html">plot</a></span>(x, y, <span class="dt">type =</span> <span class="st">'l'</span>)</code></pre></div>
<p><img src="ahn_files/figure-html/Example_1_Training-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create the Sigma dataset</span>
Sigma &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">X =</span> <span class="kw">data.frame</span>(<span class="dt">x =</span> x), <span class="dt">Y =</span> <span class="kw">data.frame</span>(<span class="dt">y =</span> y))

<span class="co"># Create network</span>
ahn &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fit.html">fit</a></span>(Sigma, <span class="dv">4</span>, <span class="fl">0.01</span>, <span class="dv">2000</span>)</code></pre></div>
<p>The trained network can be used to visualize its performance.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create test data</span>
X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x =</span> x)

<span class="co"># Simulate</span>
ysim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/predict.html">predict</a></span>(ahn, X)

<span class="kw"><a href="../reference/plot.html">plot</a></span>(x, y, <span class="dt">type =</span> <span class="st">'l'</span>)
<span class="kw">lines</span>(x, ysim, <span class="dt">type =</span> <span class="st">'l'</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">'red'</span>)
<span class="kw">legend</span>(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>, <span class="kw">c</span>(<span class="st">'Original'</span>, <span class="st">'Simulation'</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">cex =</span> <span class="fl">0.8</span>)</code></pre></div>
<p><img src="ahn_files/figure-html/Example_1_Simulation-1.png" width="672"></p>
<p>A summary of the network can be obtained with the <code>summary</code> command.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/summary.html">summary</a></span>(ahn)</code></pre></div>
<pre><code>## 
## Artificial Hydrocarbon Network trained:
## 
## Number of molecules:
##  4 
## 
## Learning factor:
##  0.01 
## 
## Overall error:
##  0.0615 
## 
## Centers of the molecules:
##                    x
## molecule1 -0.3900741
## molecule2  0.6661437
## molecule3  0.2555718
## molecule4  0.5338930
## 
## Molecules:
## Molecule 1:
##         x
## C1  0.035
## H11 3.527
## H12 3.709
## H13 1.466
## 
## Molecule 2:
##          x
## C2   3.089
## H21 -7.914
## H22  3.842
## 
## Molecule 3:
##          x
## C3   0.031
## H31  3.295
## H32 -2.165
## 
## Molecule 4:
##           x
## C4   -0.641
## H41   7.889
## H42 -11.506
## H43   4.771</code></pre>
<p>Finally, the network itself can be plotted with the <code>plot</code> command. The text of the carbon of the first molecule is in red.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot.html">plot</a></span>(ahn)</code></pre></div>
<div id="htmlwidget-4242f2fabc496833c4be" style="width:100%;height:1132.6px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4242f2fabc496833c4be">{"x":{"nodes":{"id":["C1","H11","H12","H13","C2","H21","H22","C3","H31","H32","C4","H41","H42","H43"],"shape":["circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"shadow":[false,false,false,false,false,false,false,false,false,false,false,false,false,false],"label":["0.035","3.527","3.709","1.466","3.089","-7.914","3.842","0.031","3.295","-2.165","-0.641","7.889","-11.506","4.771"],"group":["C","H1","H2","H3","C","H1","H2","C","H1","H2","C","H1","H2","H3"],"font.color":["red","black","black","black","black","black","black","black","black","black","black","black","black","black"]},"edges":{"from":["C1","C2","C3","C1","C1","C1","C2","C2","C3","C3","C4","C4","C4"],"to":["C2","C3","C4","H11","H12","H13","H21","H22","H31","H32","H41","H42","H43"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"groups":{"C":{"color":"#fbb4ae"},"H1":{"color":"#b3cde3"},"H2":{"color":"#ccebc5"},"useDefaultGroups":true,"H3":{"color":"#decbe4"}}},"groups":["C","H1","H2","H3"],"width":"100%","height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","legend":{"width":0.2,"useGroups":true,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true,"main":{"text":"Legend","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:14px;text-align:center;"}}},"evals":[],"jsHooks":[]}</script>
</div>
<div id="create-a-network-for-a-miso-sytem" class="section level2">
<h2 class="hasAnchor">
<a href="#create-a-network-for-a-miso-sytem" class="anchor"></a>Create a network for a MISO sytem</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># Create data</span>
<span class="kw">set.seed</span>(<span class="dv">12321</span>)
t &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">0</span>, <span class="dv">15</span>, <span class="fl">0.01</span>)
X &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">x1 =</span> <span class="kw">cos</span>(t), <span class="dt">x2 =</span> t)
Y &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">y =</span> <span class="kw">sin</span>(t))

<span class="co"># Create the Sigma dataset</span>
Sigma &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="dt">X =</span> X, <span class="dt">Y =</span> Y)

<span class="co"># Create network</span>
ahn &lt;-<span class="st"> </span><span class="kw"><a href="../reference/fit.html">fit</a></span>(Sigma, <span class="dv">5</span>, <span class="fl">0.01</span>, <span class="dv">2000</span>)

<span class="co"># Simulate</span>
ysim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/predict.html">predict</a></span>(ahn, X)

<span class="kw"><a href="../reference/plot.html">plot</a></span>(t, Y<span class="op">$</span>y, <span class="dt">type =</span> <span class="st">'l'</span>, <span class="dt">col =</span> <span class="st">'black'</span>, <span class="dt">xlab =</span> <span class="st">'t'</span>, <span class="dt">ylab =</span> <span class="st">'y'</span>)
<span class="kw">lines</span>(t, ysim, <span class="dt">type =</span> <span class="st">'l'</span>, <span class="dt">lty =</span> <span class="dv">2</span>, <span class="dt">col =</span> <span class="st">'red'</span>)
<span class="kw">legend</span>(<span class="dv">0</span>, <span class="op">-</span><span class="fl">0.5</span>, <span class="kw">c</span>(<span class="st">'Original'</span>, <span class="st">'Simulation'</span>), <span class="dt">col =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">lty =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>), <span class="dt">cex =</span> <span class="fl">0.6</span>)</code></pre></div>
<p><img src="ahn_files/figure-html/Example_2_Training_and_Simulation-1.png" width="672"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/summary.html">summary</a></span>(ahn)</code></pre></div>
<pre><code>## 
## Artificial Hydrocarbon Network trained:
## 
## Number of molecules:
##  5 
## 
## Learning factor:
##  0.01 
## 
## Overall error:
##  0.0681 
## 
## Centers of the molecules:
##                   x1         x2
## molecule1  0.6711820  6.3923153
## molecule2  1.1138319  1.1193610
## molecule3  0.3259886  6.4597589
## molecule4 -0.2025691  4.1373693
## molecule5 -0.1651733 13.7288473
## 
## Molecules:
## Molecule 1:
##         x1     x2
## C1  -1.768 -1.768
## H11 -2.238 -5.561
## H12 -0.332  2.051
## H13  0.310 -0.162
## 
## Molecule 2:
##         x1     x2
## C2   0.051  0.051
## H21  0.102  1.047
## H22 -0.207 -0.302
## 
## Molecule 3:
##         x1     x2
## C3  -3.023 -3.023
## H31 -0.454  2.222
## H32 -0.362 -0.169
## 
## Molecule 4:
##        x1     x2
## C4  0.780  0.780
## H41 1.681  0.539
## H42 0.699 -0.230
## 
## Molecule 5:
##         x1      x2
## C5  -2.828  -2.828
## H51 -4.667 -18.164
## H52  1.908   2.992
## H53 -0.864  -0.118</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot.html">plot</a></span>(ahn)</code></pre></div>
<div id="htmlwidget-7fabc0c69a63abde6f1e" style="width:100%;height:1132.6px;" class="visNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-7fabc0c69a63abde6f1e">{"x":{"nodes":{"id":["C1","H11","H12","H13","C2","H21","H22","C3","H31","H32","C4","H41","H42","C5","H51","H52","H53"],"shape":["circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle","circle"],"shadow":[false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false,false],"label":["-1.768\n-1.768","-2.238\n-5.561","-0.332\n2.051","0.31\n-0.162","0.051\n0.051","0.102\n1.047","-0.207\n-0.302","-3.023\n-3.023","-0.454\n2.222","-0.362\n-0.169","0.78\n0.78","1.681\n0.539","0.699\n-0.23","-2.828\n-2.828","-4.667\n-18.164","1.908\n2.992","-0.864\n-0.118"],"group":["C","H1","H2","H3","C","H1","H2","C","H1","H2","C","H1","H2","C","H1","H2","H3"],"font.color":["red","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black","black"]},"edges":{"from":["C1","C2","C3","C4","C1","C1","C1","C2","C2","C3","C3","C4","C4","C5","C5","C5"],"to":["C2","C3","C4","C5","H11","H12","H13","H21","H22","H31","H32","H41","H42","H51","H52","H53"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false},"groups":{"C":{"color":"#fbb4ae"},"H1":{"color":"#b3cde3"},"H2":{"color":"#ccebc5"},"useDefaultGroups":true,"H3":{"color":"#decbe4"}}},"groups":["C","H1","H2","H3"],"width":"100%","height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","legend":{"width":0.2,"useGroups":true,"position":"right","ncol":1,"stepX":100,"stepY":100,"zoom":true,"main":{"text":"Legend","style":"font-family:Georgia, Times New Roman, Times, serif;font-weight:bold;font-size:14px;text-align:center;"}}},"evals":[],"jsHooks":[]}</script>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#quick-start">Quick Start</a></li>
      <li><a href="#create-a-network-for-a-siso-sytem">Create a network for a SISO sytem</a></li>
      <li><a href="#create-a-network-for-a-miso-sytem">Create a network for a MISO sytem</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jose Roberto Ayala Solares.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
